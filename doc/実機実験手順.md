# 実験手順
## 準備
### ROSの設定
```
export ROS_HOSTNAME=`cat /etc/hostname`
export ROS_MASTER_URI=http://${ROS_HOSTNAME}:11311
```

### ノートPC側の準備
インターネット経由でメッセージを共有するためにMongoDBを利用するので設定を行う.
```
sudo service mongodb start        # MongoDBの起動
export ROS_MONGO_USER=common      # MongoDBのユーザー名． db2topic.py及びtopic2db.pyがDBにログインするのに利用する
export ROS_MONGO_PASS=common3605  # 同上パスワード
```
また，車いす用のノートPCをWiMAXに繋ぐ.

### TMS_DB側の準備
TMS_DBのPCで以下のコマンドを実行
```
roscore
roslaunch tms_db_manager tms_db_manager.roslaunch
roslaunch chairbot_selfsrive recvDataAtBsen.launch
rosrun chairbot_selfsrive writePose2TmsDB.py
```

## B-Senからエレベータ前までの移動実験
ViconのPCを車いすと同じネットワークにつなぐ(e.x. pot_nav_gear2.4とか)
tms_ss_viconのvicon_streamの接続先IPを変更してコンパイル
以下のコマンドを実行
```
roscore
rosrun tms_ss_vicon vicon_stream                                # viconのデータを発行
rosrun chairbot_selfdrive vicon2pose                            # viconのデータをROSのトピックに変換(geometry_msgs::PoseWithCovarianceStamped)
roslaunch tms_rc_mimamorukun_control minimal_with_tf.launch     # 車いすのドライバを起動. /mimamorukun/cmd_velから速度指令を送れるようになる
roslaunch chairbot_selfdrive move_base_coi_f2.launch            # 車いす用move_baseを起動
roslaunch chairbot_selfdrive sendData2Bsen.launch               # B-senへインターネット越しに車いすの現在座標を送信するノード
rviz /initialpose:=/mimamorukun/initialpose /move_base_simple/goal:=/mimamorukun/move_base_simple/goal -d `rospack find chairbot_selfdrive`/config/velodyne_matcher.rviz  # 地点指定のトピックを車いすに合わせてリマップ
roslaunch crop_people.launch                                    # ポータブルを利用した人物回避を利用するときのみ起動．検出された人物から，車いす周辺の人物を排除して別トピックに出力するノード．
```
Rviz上でエレベータ付近の行き先を指定

## 1階エレベータ前から屋外までの移動実験
以下のコマンドを実行
```
roscore
export ROS_NAMESPACE=mimamorukun;roslaunch velodyne_pointcloud 32e_points.launch;unset ROS_NAMESPACE  # velodyneを起動
roslaunch tms_rc_mimamorukun_control minimal_with_tf.launch   # 前述
roslaunch chairbot_selfdrive move_base.launch                 # 前述．move_base_coi_f2.launchとは利用するグリッドマップが異なる
roslaunch chairbot_selfdrive sendData2Bsen.launch             # 前述
rviz /initialpose:=/mimamorukun/initialpose /move_base_simple/goal:=/mimamorukun/move_base_simple/goal -d `rospack find chairbot_selfdrive`/config/velodyne_matcher.rviz  # 前述
```
Rviz上でエレベータ付近の行き先を指定
